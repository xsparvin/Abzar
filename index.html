<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SUB Config Decoder â€” GOD MODE</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
--bg:#0b1020;--card:#151c2f;--accent:#5c7cff;--text:#e6eef8;
--muted:#94a3b8;--border:1px solid rgba(255,255,255,.08)
}
[data-theme="light"]{
--bg:#f8fafc;--card:#fff;--accent:#4f46e5;--text:#1e293b;
--muted:#64748b;--border:1px solid rgba(0,0,0,.08)
}
*{box-sizing:border-box;font-family:Inter,Segoe UI}
body{margin:0;background:var(--bg);color:var(--text);padding:16px}
.container{max-width:1100px;margin:auto;display:grid;grid-template-columns:1fr 360px;gap:16px}
.card{background:var(--card);border-radius:16px;padding:16px;border:var(--border)}
textarea,input,button{
background:#00000030;color:var(--text);border-radius:10px;
border:var(--border);padding:12px
}
textarea{width:100%;height:380px;font-family:monospace}
button{cursor:pointer;background:var(--accent);border:none;font-weight:600}
button.ghost{background:transparent;border:var(--border)}
.tabs button{flex:1}
.row{display:flex;gap:8px;flex-wrap:wrap}
.small{font-size:13px;color:var(--muted)}
.counter span{margin-right:10px}
.history div{cursor:pointer;padding:6px;border-radius:6px}
.history div:hover{background:#ffffff10}
@media(max-width:900px){
.container{grid-template-columns:1fr}
}
</style>
</head>

<body>
<div class="container">

<!-- LEFT -->
<div class="card">
<h2>ğŸš€ SUB Config Decoder â€” God Mode</h2>
<p class="small">Paste subscription URL / config / Base64</p>

<div class="row">
<input id="sub" placeholder="https://example.com/sub.txt or vmess://..." style="flex:1">
<button onclick="generate()">Generate</button>
</div>

<div class="row" style="margin-top:8px">
<button class="ghost" onclick="copyAll()">ğŸ“‹ Copy</button>
<button class="ghost" onclick="downloadTXT()">ğŸ’¾ TXT</button>
<button class="ghost" onclick="downloadJSON()">ğŸ“¦ JSON</button>
<button class="ghost" onclick="downloadClash()">ğŸ§© Clash</button>
<button class="ghost" onclick="clearAll()">ğŸ—‘ï¸ Clear</button>
</div>

<div class="row tabs" style="margin-top:12px">
<button onclick="setTab('all')">All</button>
<button onclick="setTab('vmess')">VMESS</button>
<button onclick="setTab('vless')">VLESS</button>
<button onclick="setTab('trojan')">Trojan</button>
<button onclick="setTab('ss')">SS</button>
</div>

<input id="search" placeholder="ğŸ” Live search..." style="margin-top:10px;width:100%">

<textarea id="output" readonly></textarea>

<div class="row counter small">
<span id="cnt"></span>
</div>
</div>

<!-- RIGHT -->
<div class="card">
<div class="row">
<strong>âš™ Utilities</strong>
<button class="ghost" onclick="toggleTheme()">ğŸŒ™ / â˜€ï¸</button>
</div>

<h4>ğŸ•˜ History</h4>
<div class="history small" id="history"></div>

<h4>â„¹ Info</h4>
<ul class="small">
<li>Auto Decode Base64</li>
<li>VMESS â†’ JSON</li>
<li>Live Filter</li>
<li>LocalStorage History</li>
</ul>
</div>

</div>

<script>
const out=document.getElementById("output");
const sub=document.getElementById("sub");
let allLines=[],currentTab="all";

/* ---------- Base64 ---------- */
const isB64=s=>{try{return btoa(atob(s.replace(/\s+/g,'')))===s.replace(/\s+/g,'')}catch{return false}}
const dec=s=>{try{return atob(s)}catch{return null}}

/* ---------- VMESS ---------- */
function decodeVmess(l){
try{
let j=JSON.parse(atob(l.replace("vmess://","")));
return j
}catch{return null}
}

/* ---------- Generate ---------- */
async function generate(){
let v=sub.value.trim(); if(!v) return;
saveHistory(v);

if(v.startsWith("http")){
let r=await fetch(v); v=await r.text();
}

let lines=v.split(/\r?\n/).filter(Boolean);
let res=[];

lines.forEach(l=>{
if(l.startsWith("vmess://")){
let j=decodeVmess(l);
if(j){
res.push("### "+(j.ps||"VMESS"));
res.push(JSON.stringify(j,null,2));
}else res.push(l);
}
else if(isB64(l)){
let d=dec(l); res.push(d||l)
}else res.push(l)
});

allLines=res;
render();
}

/* ---------- Render ---------- */
function render(){
let q=document.getElementById("search").value.toLowerCase();
let f=allLines.filter(l=>{
if(currentTab!=="all" && !l.startsWith(currentTab+"://")) return false;
return l.toLowerCase().includes(q);
});
out.value=f.join("\n\n");
count();
}

/* ---------- Counter ---------- */
function count(){
let m={vmess:0,vless:0,trojan:0,ss:0};
allLines.forEach(l=>{
Object.keys(m).forEach(p=>l.startsWith(p+"://")&&m[p]++)
});
document.getElementById("cnt").textContent=
`VMESS:${m.vmess} | VLESS:${m.vless} | Trojan:${m.trojan} | SS:${m.ss}`;
}

/* ---------- Tabs ---------- */
function setTab(t){currentTab=t;render()}

/* ---------- Search ---------- */
document.getElementById("search").oninput=render;

/* ---------- Export ---------- */
function copyAll(){navigator.clipboard.writeText(out.value)}
function downloadTXT(){dl(out.value,"configs.txt")}
function downloadJSON(){dl(JSON.stringify(allLines,null,2),"configs.json")}
function downloadClash(){
let y="proxies:\n";
allLines.filter(l=>l.startsWith("vmess://")).forEach((l,i)=>{
y+=`- name: vmess-${i}\n  type: vmess\n`;
});
dl(y,"clash.yaml")
}
function dl(c,n){
let a=document.createElement("a");
a.href=URL.createObjectURL(new Blob([c]));
a.download=n;a.click();
}

/* ---------- Theme ---------- */
function toggleTheme(){
let t=document.documentElement.getAttribute("data-theme");
t=t==="light"?"dark":"light";
document.documentElement.setAttribute("data-theme",t);
localStorage.theme=t;
}
if(localStorage.theme)
document.documentElement.setAttribute("data-theme",localStorage.theme);

/* ---------- History ---------- */
function saveHistory(v){
let h=JSON.parse(localStorage.h||"[]");
h.unshift(v); h=[...new Set(h)].slice(0,5);
localStorage.h=JSON.stringify(h); loadHistory();
}
function loadHistory(){
let h=JSON.parse(localStorage.h||"[]");
let el=document.getElementById("history");
el.innerHTML="";
h.forEach(x=>{
let d=document.createElement("div");
d.textContent=x.slice(0,40);
d.onclick=()=>{sub.value=x;generate()}
el.appendChild(d);
});
}
loadHistory();

function clearAll(){sub.value="";out.value="";allLines=[]}
</script>
</body>
</html>